apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: dvecdb-staging

namePrefix: staging-

commonLabels:
  environment: staging

bases:
- ../../base

replicas:
- name: dvecdb
  count: 2

patches:
- patch: |-
    apiVersion: apps/v1
    kind: StatefulSet
    metadata:
      name: dvecdb
    spec:
      template:
        spec:
          containers:
          - name: dvecdb
            resources:
              requests:
                memory: "2Gi"
                cpu: "500m"
              limits:
                memory: "8Gi"
                cpu: "4"
          volumeClaimTemplates:
          - metadata:
              name: data
            spec:
              resources:
                requests:
                  storage: 50Gi

configMapGenerator:
- name: dvecdb-config
  behavior: merge
  literals:
  - LOG_LEVEL=info
  - RUST_LOG=info
  - TOKIO_WORKER_THREADS=8
